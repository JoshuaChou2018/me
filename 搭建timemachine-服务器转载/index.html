<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>搭建Time Machine 服务器 （转载） - Juexiao Zhou</title><meta name="Description" content="Juexiao Zhou&#39;s personal site"><meta property="og:title" content="搭建Time Machine 服务器 （转载）" />
<meta property="og:description" content="本文转载自：https://zhuanlan.zhihu.com/p/31088141
本文的内容分为：
 Time Machine 是什么？ 自建Time Machine 服务器的理由 硬件的选择 软件的部署 Mac 备份到Time Machine 服务器 从Time Machine 服务器恢复Mac  Time Machine 是什么？ Time Machine是macOS中一个非常强大的功能，Time Machine能够保留：
 本地快照（只要空间允许） 过去24小时的每小时备份 过去一个月的每日备份 过去所有月份的每周备份  Time Machine的备份是增量备份，只会备份自上次备份以来有变动的文件，因此备份速度很快，占用的空间也不多。如果Time Machine 占满了磁盘空间，最早的备份会被自动删除。
引用知友
@Xing
在OS X 中的 Time Machine 真的有用吗？中的回答：
 只要使用Time Machine备份过，即使原来的Mac在Windows双系统下渲染片子时突然蓝屏被你一气之下砸坏或者在麦当劳吃晚饭时被人连电脑包顺走，你也只需走进Apple Store，买一台新Mac，回家连上Time Capsule或者插上含有备份的硬盘，按住option开机进入recovery分区，选择从Time Machine中恢复。开机后打开迁移助手Migration Assistant，选择从Time Machine备份中恢复。等你小憩醒来，将会看到一台和之前一模一样的Mac，不仅是图库音乐库昨晚看过的美剧进度，包括所有设置、开机启动项浏览器历史都是完全一致的。 当然上面只是Time Machine顺滑体验的一部分，Time Machine可以带你回到每一个有记录的节点，例如你有一个project几个月前 从零开始做，在Time Machine中可以演绎整个project文件夹内的变化，同时可以把某个时间任何文件揪出来。这感觉就像你有一麻袋后悔药，想怎么来就怎么来。
 使用Time Machine，你既可以回到过去某个时刻，提取某个文件在当时的版本；也可以在电脑异常崩溃后直接全盘恢复到过去某个时刻的状态。
自建Time Machine 服务器的理由 Time Machine的使用方法有三种：
 使用一块外置的USB移动硬盘，要求文件系统是HFS&#43;。 使用苹果的AirPort网络设备，通过有线网络/无线网络的方式备份到Airport的硬盘上。 使用Mac mini，安装「macOS Server」使之成为AFP协议传输的文件服务器，Time Machine备份到文件服务器上。  方法1." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.joshuachou.ink/%E6%90%AD%E5%BB%BAtimemachine-%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%BD%AC%E8%BD%BD/" /><meta property="og:image" content="https://www.joshuachou.ink/logo.png"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-01-29T00:00:00+00:00" />
<meta property="article:modified_time" content="2022-01-29T00:00:00+00:00" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://www.joshuachou.ink/logo.png"/>

<meta name="twitter:title" content="搭建Time Machine 服务器 （转载）"/>
<meta name="twitter:description" content="本文转载自：https://zhuanlan.zhihu.com/p/31088141
本文的内容分为：
 Time Machine 是什么？ 自建Time Machine 服务器的理由 硬件的选择 软件的部署 Mac 备份到Time Machine 服务器 从Time Machine 服务器恢复Mac  Time Machine 是什么？ Time Machine是macOS中一个非常强大的功能，Time Machine能够保留：
 本地快照（只要空间允许） 过去24小时的每小时备份 过去一个月的每日备份 过去所有月份的每周备份  Time Machine的备份是增量备份，只会备份自上次备份以来有变动的文件，因此备份速度很快，占用的空间也不多。如果Time Machine 占满了磁盘空间，最早的备份会被自动删除。
引用知友
@Xing
在OS X 中的 Time Machine 真的有用吗？中的回答：
 只要使用Time Machine备份过，即使原来的Mac在Windows双系统下渲染片子时突然蓝屏被你一气之下砸坏或者在麦当劳吃晚饭时被人连电脑包顺走，你也只需走进Apple Store，买一台新Mac，回家连上Time Capsule或者插上含有备份的硬盘，按住option开机进入recovery分区，选择从Time Machine中恢复。开机后打开迁移助手Migration Assistant，选择从Time Machine备份中恢复。等你小憩醒来，将会看到一台和之前一模一样的Mac，不仅是图库音乐库昨晚看过的美剧进度，包括所有设置、开机启动项浏览器历史都是完全一致的。 当然上面只是Time Machine顺滑体验的一部分，Time Machine可以带你回到每一个有记录的节点，例如你有一个project几个月前 从零开始做，在Time Machine中可以演绎整个project文件夹内的变化，同时可以把某个时间任何文件揪出来。这感觉就像你有一麻袋后悔药，想怎么来就怎么来。
 使用Time Machine，你既可以回到过去某个时刻，提取某个文件在当时的版本；也可以在电脑异常崩溃后直接全盘恢复到过去某个时刻的状态。
自建Time Machine 服务器的理由 Time Machine的使用方法有三种：
 使用一块外置的USB移动硬盘，要求文件系统是HFS&#43;。 使用苹果的AirPort网络设备，通过有线网络/无线网络的方式备份到Airport的硬盘上。 使用Mac mini，安装「macOS Server」使之成为AFP协议传输的文件服务器，Time Machine备份到文件服务器上。  方法1."/>
<meta name="application-name" content="Juexiao Zhou">
<meta name="apple-mobile-web-app-title" content="Juexiao Zhou"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://www.joshuachou.ink/%E6%90%AD%E5%BB%BAtimemachine-%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%BD%AC%E8%BD%BD/" /><link rel="prev" href="https://www.joshuachou.ink/lc10.regular_expression_matching/" /><link rel="next" href="https://www.joshuachou.ink/lc938.range_sum_of_bst/" /><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/normalize.css@8.0.1/normalize.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.13.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.7.2/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "搭建Time Machine 服务器 （转载）",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/www.joshuachou.ink\/%E6%90%AD%E5%BB%BAtimemachine-%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%BD%AC%E8%BD%BD\/"
        },"image": ["https:\/\/www.joshuachou.ink\/images\/Apple-Devices-Preview.png"],"genre": "posts","keywords": "system, linux","wordcount":  712 ,
        "url": "https:\/\/www.joshuachou.ink\/%E6%90%AD%E5%BB%BAtimemachine-%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%BD%AC%E8%BD%BD\/","datePublished": "2022-01-29T00:00:00+00:00","dateModified": "2022-01-29T00:00:00+00:00","license": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher": {
            "@type": "Organization",
            "name": "xxxx","logo": {
                    "@type": "ImageObject",
                    "url": "https:\/\/www.joshuachou.ink\/images\/avatar.png",
                    "width":  2132 ,
                    "height":  2132 
                }},"author": {
                "@type": "Person",
                "name": "Juexiao Zhou"
            },"description": ""
    }
    </script></head>
    <body header-desktop="fixed" header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Juexiao Zhou">Juexiao Zhou</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/" title="Posts"> Posts </a><a class="menu-item" href="/publications/" title="Publications"> Publications </a><a class="menu-item" href="/about/" title="Me"> Me </a><a class="menu-item" href="/categories/" title="Categories"> Categories </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Juexiao Zhou">Juexiao Zhou</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="/posts/" title="Posts">Posts</a><a class="menu-item" href="/publications/" title="Publications">Publications</a><a class="menu-item" href="/about/" title="Me">Me</a><a class="menu-item" href="/categories/" title="Categories">Categories</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw"></i>
            </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animated flipInX">搭建Time Machine 服务器 （转载）</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="/" title="Author" rel=" author" class="author"><i class="fas fa-user-circle fa-fw"></i>Juexiao Zhou</a></span>&nbsp;<span class="post-category">included in <a href="/categories/system/"><i class="far fa-folder fa-fw"></i>system</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2022-01-29">2022-01-29</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;712 words&nbsp;
                <i class="far fa-clock fa-fw"></i>&nbsp;4 minutes&nbsp;</div>
        </div><div class="details toc" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#time-machine-是什么">Time Machine 是什么？</a></li>
    <li><a href="#自建time-machine-服务器的理由">自建Time Machine 服务器的理由</a></li>
    <li><a href="#硬件选择">硬件选择</a></li>
    <li><a href="#软件的部署">软件的部署</a></li>
    <li><a href="#mac-备份到time-machine-服务器">Mac 备份到Time Machine 服务器</a></li>
    <li><a href="#从time-machine-服务器恢复mac">从Time Machine 服务器恢复Mac</a></li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><p><strong>本文转载自：https://zhuanlan.zhihu.com/p/31088141</strong></p>
<p>本文的内容分为：</p>
<ul>
<li>Time Machine 是什么？</li>
<li>自建Time Machine 服务器的理由</li>
<li>硬件的选择</li>
<li>软件的部署</li>
<li>Mac 备份到Time Machine 服务器</li>
<li>从Time Machine 服务器恢复Mac</li>
</ul>
<h2 id="time-machine-是什么">Time Machine 是什么？</h2>
<p>Time Machine是macOS中一个非常强大的功能，Time Machine能够保留：</p>
<ul>
<li>本地快照（只要空间允许）</li>
<li>过去24小时的每小时备份</li>
<li>过去一个月的每日备份</li>
<li>过去所有月份的每周备份</li>
</ul>
<p>Time Machine的备份是增量备份，只会备份自上次备份以来有变动的文件，因此备份速度很快，占用的空间也不多。如果Time Machine 占满了磁盘空间，最早的备份会被自动删除。</p>
<p>引用知友</p>
<p><a href="https://www.zhihu.com/people/f42bb95d1448482e4aae658a19f6ed0b" target="_blank" rel="noopener noreffer">@Xing</a></p>
<p>在<a href="https://www.zhihu.com/question/21277559/answer/18483790" target="_blank" rel="noopener noreffer">OS X 中的 Time Machine 真的有用吗？</a>中的回答：</p>
<blockquote>
<p>只要使用Time Machine备份过，即使原来的Mac在Windows双系统下渲染片子时突然蓝屏被你一气之下砸坏或者在麦当劳吃晚饭时被人连电脑包顺走，你也只需走进Apple Store，买一台新Mac，回家连上Time Capsule或者插上含有备份的硬盘，<del>按住option开机进入recovery分区，选择从Time Machine中恢复。</del>开机后打开迁移助手Migration Assistant，选择从Time Machine备份中恢复。等你小憩醒来，将会看到一台和之前一模一样的Mac，不仅是图库音乐库昨晚看过的美剧进度，包括所有设置、开机启动项浏览器历史都是完全一致的。
当然上面只是Time Machine顺滑体验的一部分，Time Machine可以带你回到每一个有记录的节点，例如你有一个project几个月前 从零开始做，在Time Machine中可以演绎整个project文件夹内的变化，同时可以把某个时间任何文件揪出来。这感觉就像你有一麻袋后悔药，想怎么来就怎么来。</p>
</blockquote>
<p>使用Time Machine，你既可以<strong>回到过去某个时刻，提取某个文件在当时的版本</strong>；也可以在电脑异常崩溃后直接<strong>全盘恢复到过去某个时刻的状态</strong>。</p>
<h2 id="自建time-machine-服务器的理由">自建Time Machine 服务器的理由</h2>
<p>Time Machine的使用方法有三种：</p>
<ol>
<li>使用一块外置的USB移动硬盘，要求文件系统是HFS+。</li>
<li>使用苹果的AirPort网络设备，通过有线网络/无线网络的方式备份到Airport的硬盘上。</li>
<li>使用Mac mini，安装「macOS Server」使之成为AFP协议传输的文件服务器，Time Machine备份到文件服务器上。</li>
</ol>
<p>方法1. 外置的USB移动硬盘需要总是挂在Mac上占用一个USB接口，对于有移动需求的MacBook要经常插拔，我经常会忘记弹出直接拔，或者忘记去停下备份中的Time Machine直接拔，长此以往容易造成硬盘的损坏。</p>
<p>方法2. 中可选的Airport设备有两款，分别是AirPort Extreme和AirPort Time Capsule (2TB/3TB)，除了售价高昂之外，性能孱弱，功能单一，最新款发布于2013年，产品线已经多年没有更新。</p>
<p>方法3. 如果不考虑价格，是事实上的最优解，但是对于一般用户如果只是想要单纯的作「Time Machine服务器」似乎费效比太高。</p>
<p>因此，我的目标是自建一台低成本低功耗长期运行的服务器，在服务器上部署Time Machine server服务，并且具有性能/功能的冗余，以应对日后产生的需求。</p>
<h2 id="硬件选择">硬件选择</h2>
<p>我购买了一个X86的准系统：</p>
<p>尺寸：160<em>120</em>37，重量：600g，功耗：6-12W，全铝设计无风扇被动散热。</p>
<p>CPU：14nm Intel® Celeron® N3150 四核心 1.6GHz, 最高2.08GHz, 内建Intel HD Graphics 4K 显示核心。</p>
<p>前置面板：4个原生USB3.0，2个USB2.0。</p>
<p>后置面板：12V-19V宽幅电压外接直流供电，2个HDMI，2个千兆有线网口，3.5mm音频输入/输出，2个SMA天线座。</p>
<p>板载：SATA3 6Gb/s机械硬盘插槽（蓝色），MSATA3 6Gb/s固态硬盘插槽（橙色），mini PCIe无线网卡插槽（红色），DDR3L-1600内存插槽（黄色）。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-464e560a7dd0f5afa0fe029c48d6acf3_1440w.DjUIAl.jpg"
        data-srcset="https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-464e560a7dd0f5afa0fe029c48d6acf3_1440w.DjUIAl.jpg, https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-464e560a7dd0f5afa0fe029c48d6acf3_1440w.DjUIAl.jpg 1.5x, https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-464e560a7dd0f5afa0fe029c48d6acf3_1440w.DjUIAl.jpg 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-464e560a7dd0f5afa0fe029c48d6acf3_1440w.DjUIAl.jpg"
        title="img" /></p>
<p>另外购买了相关硬件：</p>
<p>内存：威刚(ADATA) DDR3L 1G 1600 笔记本内存；</p>
<p>固态硬盘：闪迪(SanDisk) i100 32G MSATA3 MLC SSD；</p>
<p>无线网卡：博通(Broadcom) BCM94352hmb 802.11ac + 蓝牙4.0；</p>
<p>机械硬盘：昱科(HGST) 500G SATA3 7200转32M 笔记本硬盘。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-ad995649ecd6dbc42709278e1e27611b_1440w.JLlCh6.jpg"
        data-srcset="https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-ad995649ecd6dbc42709278e1e27611b_1440w.JLlCh6.jpg, https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-ad995649ecd6dbc42709278e1e27611b_1440w.JLlCh6.jpg 1.5x, https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-ad995649ecd6dbc42709278e1e27611b_1440w.JLlCh6.jpg 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-ad995649ecd6dbc42709278e1e27611b_1440w.JLlCh6.jpg"
        title="img" /></p>
<p>组装好之后，与MacBook Pro 13大小比较。总计开销1180=准系统550+内存80+固态硬盘80+无线网卡200+机械硬盘270。</p>
<h2 id="软件的部署">软件的部署</h2>
<p>安装Linux，我选择的是Ubuntu Server 16.04.3 LTS，以下以此为例，我的账户名为tmback，密码为tmback，主机名为TMBack-Server。</p>
<p>SSH登陆：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">ssh tmback@tmback-server.local
</span></span></code></pre></td></tr></table>
</div>
</div><p>首先，查看识别到的硬盘：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">~$ sudo fdisk -l
</span></span></code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-c82f1f3a59c0b3471daf0cb322cf47cf_1440w.KtzIQL.jpg"
        data-srcset="https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-c82f1f3a59c0b3471daf0cb322cf47cf_1440w.KtzIQL.jpg, https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-c82f1f3a59c0b3471daf0cb322cf47cf_1440w.KtzIQL.jpg 1.5x, https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-c82f1f3a59c0b3471daf0cb322cf47cf_1440w.KtzIQL.jpg 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-c82f1f3a59c0b3471daf0cb322cf47cf_1440w.KtzIQL.jpg"
        title="img" /></p>
<p>sda是系统所在的SSD，sdb就是我要用来作Time Machine备份的硬盘，把这个硬盘格式化为Linux的EXT4文件格式：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">~$ sudo mkfs.ext4  /dev/sdb1
</span></span></code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-c267b38669c816fb8ae5bcbbb5cfb93a_1440w.1NCF66.jpg"
        data-srcset="https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-c267b38669c816fb8ae5bcbbb5cfb93a_1440w.1NCF66.jpg, https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-c267b38669c816fb8ae5bcbbb5cfb93a_1440w.1NCF66.jpg 1.5x, https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-c267b38669c816fb8ae5bcbbb5cfb93a_1440w.1NCF66.jpg 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-c267b38669c816fb8ae5bcbbb5cfb93a_1440w.1NCF66.jpg"
        title="img" /></p>
<p>把格式化好的分区起个名字就叫TMBack：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">~$ sudo e2label /dev/sdb1 TMBack
</span></span></code></pre></td></tr></table>
</div>
</div><p>在/media创建一个目录，把sdb1挂载上去：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">~$ sudo mkdir /media/TMBack
</span></span><span class="line"><span class="cl">~$ sudo mount /dev/sdb1 /media/TMBack 
</span></span></code></pre></td></tr></table>
</div>
</div><p>把/media/TMBack目录所有者修改为tmback:tmback</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">~$ sudo chown -R tmback:tmback /media/TMBack
</span></span></code></pre></td></tr></table>
</div>
</div><p>安装Netatalk服务，项目主页<a href="https://link.zhihu.com/?target=http%3A//netatalk.sourceforge.net/" target="_blank" rel="noopener noreffer">Netatalk</a>。</p>
<blockquote>
<p>Netatalk is an OpenSource software package, that can be used to turn a *NIX machine into an extremely high-performance and reliable file server for Macintosh computers.
Using Netatalk&rsquo;s AFP 3.3 compliant file-server leads to significantly higher transmission speeds compared with Macs accessing a server via SaMBa/NFS while providing clients with the best possible user experience (full support for Macintosh metadata, flawlessly supporting mixed environments of classic Mac OS and OS X clients)</p>
</blockquote>
<p>用来把Linux/Unix伪装成AFP协议传输的文件服务器：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">~$ sudo apt-get install netatalk
</span></span></code></pre></td></tr></table>
</div>
</div><p>修改Netatalk的配置文件：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">~$ sudo nano /etc/netatalk/AppleVolumes.default
</span></span></code></pre></td></tr></table>
</div>
</div><p>在末尾加上这么一句：「/media/TMBack &ldquo;TMback&rdquo; options:tm」</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-ceefd2e6d480078cf4c636186206657e_1440w.ODld3N.jpg"
        data-srcset="https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-ceefd2e6d480078cf4c636186206657e_1440w.ODld3N.jpg, https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-ceefd2e6d480078cf4c636186206657e_1440w.ODld3N.jpg 1.5x, https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-ceefd2e6d480078cf4c636186206657e_1440w.ODld3N.jpg 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-ceefd2e6d480078cf4c636186206657e_1440w.ODld3N.jpg"
        title="img" /></p>
<p>重启Netatalk服务：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">~$ sudo service netatalk restart
</span></span></code></pre></td></tr></table>
</div>
</div><p>这时在网络上就能发现一台新的，主机名为「tmback-server」的Mac主机。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-a30a61eb588faa89f5fa427d39fc8e68_1440w.MISPNj.jpg"
        data-srcset="https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-a30a61eb588faa89f5fa427d39fc8e68_1440w.MISPNj.jpg, https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-a30a61eb588faa89f5fa427d39fc8e68_1440w.MISPNj.jpg 1.5x, https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-a30a61eb588faa89f5fa427d39fc8e68_1440w.MISPNj.jpg 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-a30a61eb588faa89f5fa427d39fc8e68_1440w.MISPNj.jpg"
        title="img" /></p>
<p>用刚刚设的账户名tmback密码tmback登陆。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-862778d88cfef721bd7ab1d28f62550b_1440w.KXpxaF.jpg"
        data-srcset="https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-862778d88cfef721bd7ab1d28f62550b_1440w.KXpxaF.jpg, https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-862778d88cfef721bd7ab1d28f62550b_1440w.KXpxaF.jpg 1.5x, https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-862778d88cfef721bd7ab1d28f62550b_1440w.KXpxaF.jpg 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-862778d88cfef721bd7ab1d28f62550b_1440w.KXpxaF.jpg"
        title="img" /></p>
<p>能看到挂载的硬盘TMBack目录。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-2dd8c5ee4eaf18630955b1bffc8a3abc_1440w.jWnVQn.jpg"
        data-srcset="https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-2dd8c5ee4eaf18630955b1bffc8a3abc_1440w.jWnVQn.jpg, https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-2dd8c5ee4eaf18630955b1bffc8a3abc_1440w.jWnVQn.jpg 1.5x, https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-2dd8c5ee4eaf18630955b1bffc8a3abc_1440w.jWnVQn.jpg 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-2dd8c5ee4eaf18630955b1bffc8a3abc_1440w.jWnVQn.jpg"
        title="img" /></p>
<p>安装avahi-daemon，项目主页<a href="https://link.zhihu.com/?target=https%3A//www.avahi.org/" target="_blank" rel="noopener noreffer">avahi - mDNS/DNS-SD</a>。</p>
<blockquote>
<p>Avahi is a system which facilitates service discovery on a local network via the mDNS/DNS-SD protocol suite. This enables you to plug your laptop or computer into a network and instantly be able to view other people who you can chat with, find printers to print to or find files being shared. Compatible technology is found in Apple MacOS X (branded &ldquo;<a href="https://link.zhihu.com/?target=http%3A//www.apple.com/macosx/features/bonjour/" target="_blank" rel="noopener noreffer">Bonjour</a>&rdquo; and sometimes &ldquo;Zeroconf&rdquo;).
Avahi is primarily targetted at Linux systems and ships by default in most distributions. It is not ported to Windows at this stage, but will run on many other BSD-like systems. The primary API is D-Bus and is required for usage of most of Avahi, however services can be published using an XML service definition placed in /etc/avahi/services.</p>
</blockquote>
<p>用来在Linux/Unix中开启类似的Bonjour的服务：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">~$ sudo apt-get install avahi-daemon
</span></span></code></pre></td></tr></table>
</div>
</div><p>然后我们新建一个它的服务：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">~$ sudo nano /etc/avahi/services/afpd.service
</span></span></code></pre></td></tr></table>
</div>
</div><p>输入以下内容：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">&lt;?xml version=&#34;1.0&#34; standalone=&#39;no&#39;?&gt;&lt;!--*-nxml-*--&gt;
</span></span><span class="line"><span class="cl">&lt;!DOCTYPE service-group SYSTEM &#34;avahi-service.dtd&#34;&gt;
</span></span><span class="line"><span class="cl">&lt;service-group&gt;
</span></span><span class="line"><span class="cl">	&lt;name replace-wildcards=&#34;yes&#34;&gt;%h&lt;/name&gt;
</span></span><span class="line"><span class="cl">	&lt;service&gt;
</span></span><span class="line"><span class="cl">        &lt;type&gt;_afpovertcp._tcp&lt;/type&gt;
</span></span><span class="line"><span class="cl">        &lt;port&gt;548&lt;/port&gt;
</span></span><span class="line"><span class="cl">    &lt;/service&gt;
</span></span><span class="line"><span class="cl">    &lt;service&gt;
</span></span><span class="line"><span class="cl">        &lt;type&gt;_device-info._tcp&lt;/type&gt;
</span></span><span class="line"><span class="cl"> 	       &lt;port&gt;0&lt;/port&gt;
</span></span><span class="line"><span class="cl">        &lt;txt-record&gt;model=Xserve&lt;/txt-record&gt;
</span></span><span class="line"><span class="cl">    &lt;/service&gt;
</span></span><span class="line"><span class="cl">&lt;/service-group&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>重启avahi-daemon服务：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">~$ sudo service avahi-daemon restart
</span></span></code></pre></td></tr></table>
</div>
</div><p>这时「tmback-server」变成了一台Mac文件服务器。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-01fdd713e9cb7d1e3b2ce205007f2484_1440w.329RHZ.jpg"
        data-srcset="https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-01fdd713e9cb7d1e3b2ce205007f2484_1440w.329RHZ.jpg, https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-01fdd713e9cb7d1e3b2ce205007f2484_1440w.329RHZ.jpg 1.5x, https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-01fdd713e9cb7d1e3b2ce205007f2484_1440w.329RHZ.jpg 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-01fdd713e9cb7d1e3b2ce205007f2484_1440w.329RHZ.jpg"
        title="img" /></p>
<p>如果关闭ubuntu，你还会在Mac上收到通知。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-3e05ad4dd11b68daaf379948d52e125b_1440w.mM2JHg.jpg"
        data-srcset="https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-3e05ad4dd11b68daaf379948d52e125b_1440w.mM2JHg.jpg, https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-3e05ad4dd11b68daaf379948d52e125b_1440w.mM2JHg.jpg 1.5x, https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-3e05ad4dd11b68daaf379948d52e125b_1440w.mM2JHg.jpg 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-3e05ad4dd11b68daaf379948d52e125b_1440w.mM2JHg.jpg"
        title="img" /></p>
<p>安装nss-mdns，项目主页<a href="https://link.zhihu.com/?target=http%3A//0pointer.de/lennart/projects/nss-mdns/" target="_blank" rel="noopener noreffer">nss-mdns 0.10</a>。</p>
<blockquote>
<p>nss-mdns is a plugin for the GNU Name Service Switch (NSS) functionality of the GNU C Library (glibc) providing host name resolution via <a href="https://link.zhihu.com/?target=http%3A//www.multicastdns.org/" target="_blank" rel="noopener noreffer">Multicast DNS</a> (aka <em>Zeroconf</em>, aka <em>Apple Rendezvous</em>, aka <em>Apple Bonjour</em>), effectively allowing name resolution by common Unix/Linux programs in the ad-hoc mDNS domain .local.
nss-mdns provides client functionality only, which means that you have to run a mDNS responder daemon seperately from nss-mdns if you want to register the local host name via mDNS. I recommend <a href="https://link.zhihu.com/?target=http%3A//avahi.org/" target="_blank" rel="noopener noreffer">Avahi</a>.
nss-mdns is very lightweight (9 KByte stripped binary .so compiled with -DNDEBUG=1 -Os on i386, gcc 4.0), has no dependencies besides the glibc and requires only minimal configuration.
By default nss-mdns tries to contact a running <a href="https://link.zhihu.com/?target=http%3A//avahi.org/" target="_blank" rel="noopener noreffer">avahi-daemon</a> for resolving host names and addresses and making use of its superior record cacheing. Optionally nss-mdns can be compiled with a mini mDNS stack that can be used to resolve host names without a local Avahi installation. Both Avahi support and this mini mDNS stack are optional, however at least one of them needs to be enabled. If both are enabled a connection to Avahi is tried first, and if that fails the mini mDNS stack is used.</p>
</blockquote>
<p>用来配合刚刚设置好的avahi-daemon：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">~$ sudo apt-get install libnss-mdns
</span></span></code></pre></td></tr></table>
</div>
</div><p>修改nss-mdns配置文件：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">~$ sudo nano /etc/nsswitch.conf
</span></span></code></pre></td></tr></table>
</div>
</div><p>在「hosts」这一行的结尾添加两项，「mdns4」和「mdns」：</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-2a754f13d4d47d1b0c64c657f1187d13_1440w.nq6EbL.jpg"
        data-srcset="https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-2a754f13d4d47d1b0c64c657f1187d13_1440w.nq6EbL.jpg, https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-2a754f13d4d47d1b0c64c657f1187d13_1440w.nq6EbL.jpg 1.5x, https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-2a754f13d4d47d1b0c64c657f1187d13_1440w.nq6EbL.jpg 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-2a754f13d4d47d1b0c64c657f1187d13_1440w.nq6EbL.jpg"
        title="img" /></p>
<p>再次重启avahi-daemon服务：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">~$ sudo service avahi-daemon restart
</span></span></code></pre></td></tr></table>
</div>
</div><p>最后一步我们要开机自动挂载机械硬盘。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">~$ blkid
</span></span></code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-d7f18954d617013165abcca8edda0309_1440w.T20Noo.jpg"
        data-srcset="https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-d7f18954d617013165abcca8edda0309_1440w.T20Noo.jpg, https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-d7f18954d617013165abcca8edda0309_1440w.T20Noo.jpg 1.5x, https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-d7f18954d617013165abcca8edda0309_1440w.T20Noo.jpg 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-d7f18954d617013165abcca8edda0309_1440w.T20Noo.jpg"
        title="img" /></p>
<p>机械硬盘的UUID=&ldquo;5202aacf-9e77-4768-b4ec-d6009adbb179&rdquo;</p>
<p>编辑启动文件：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">~$ sudo nano /etc/fstab
</span></span></code></pre></td></tr></table>
</div>
</div><p>加上这一行：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">UUID=5202aacf-9e77-4768-b4ec-d6009adbb179 /media/TMBack ext4 defaults 0 0
</span></span></code></pre></td></tr></table>
</div>
</div><p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-a09d076dc706a8f71872dad240b45f1f_1440w.z8IGb4.jpg"
        data-srcset="https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-a09d076dc706a8f71872dad240b45f1f_1440w.z8IGb4.jpg, https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-a09d076dc706a8f71872dad240b45f1f_1440w.z8IGb4.jpg 1.5x, https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-a09d076dc706a8f71872dad240b45f1f_1440w.z8IGb4.jpg 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-a09d076dc706a8f71872dad240b45f1f_1440w.z8IGb4.jpg"
        title="img" /></p>
<p>现在软件部署就完成了，重启ubuntu。</p>
<h2 id="mac-备份到time-machine-服务器">Mac 备份到Time Machine 服务器</h2>
<p>系统偏好设置&ndash;&gt;Time Machine&ndash;&gt;选择备份磁盘</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-3fa3a7107650d6feecf4d535031c3a26_1440w.EwQ1Hc.jpg"
        data-srcset="https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-3fa3a7107650d6feecf4d535031c3a26_1440w.EwQ1Hc.jpg, https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-3fa3a7107650d6feecf4d535031c3a26_1440w.EwQ1Hc.jpg 1.5x, https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-3fa3a7107650d6feecf4d535031c3a26_1440w.EwQ1Hc.jpg 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-3fa3a7107650d6feecf4d535031c3a26_1440w.EwQ1Hc.jpg"
        title="img" /></p>
<p>会发现一个名为「TMBack」的网络共享磁盘，选择它。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-1a117b4c6bdb0c911b88982e9c9584dc_1440w.ifyQpN.jpg"
        data-srcset="https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-1a117b4c6bdb0c911b88982e9c9584dc_1440w.ifyQpN.jpg, https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-1a117b4c6bdb0c911b88982e9c9584dc_1440w.ifyQpN.jpg 1.5x, https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-1a117b4c6bdb0c911b88982e9c9584dc_1440w.ifyQpN.jpg 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-1a117b4c6bdb0c911b88982e9c9584dc_1440w.ifyQpN.jpg"
        title="img" /></p>
<p>用我们之前设的账户名tmback密码tmback登陆。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-6fcb4d2a391fef29fb705a27aa2ffa87_1440w.Tmcrwj.jpg"
        data-srcset="https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-6fcb4d2a391fef29fb705a27aa2ffa87_1440w.Tmcrwj.jpg, https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-6fcb4d2a391fef29fb705a27aa2ffa87_1440w.Tmcrwj.jpg 1.5x, https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-6fcb4d2a391fef29fb705a27aa2ffa87_1440w.Tmcrwj.jpg 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-6fcb4d2a391fef29fb705a27aa2ffa87_1440w.Tmcrwj.jpg"
        title="img" /></p>
<p>耐心等待首次备份完成，嫌慢的话，把ubuntu和Mac都插上千兆网线，备份速度不输给外置USB硬盘备份。</p>
<p>此后，只要Mac与ubuntu处在同一个网络内，就会自动进行备份，Mac脱离网络则备份会自动停止，一切都是无感的。</p>
<h2 id="从time-machine-服务器恢复mac">从Time Machine 服务器恢复Mac</h2>
<p>按住「command+R」启动Mac，直到进入「Recovery」模式。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-88fab67c08638a073269cdd3adc3bf30_1440w.ZHCcnh.jpg"
        data-srcset="https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-88fab67c08638a073269cdd3adc3bf30_1440w.ZHCcnh.jpg, https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-88fab67c08638a073269cdd3adc3bf30_1440w.ZHCcnh.jpg 1.5x, https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-88fab67c08638a073269cdd3adc3bf30_1440w.ZHCcnh.jpg 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-88fab67c08638a073269cdd3adc3bf30_1440w.ZHCcnh.jpg"
        title="img" /></p>
<p>选择「从Time Machine 备份进行恢复」。</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-b26b65c7c3883d3d3a3a0dcf5e59cdd5_1440w.Pk0Ya0.jpg"
        data-srcset="https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-b26b65c7c3883d3d3a3a0dcf5e59cdd5_1440w.Pk0Ya0.jpg, https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-b26b65c7c3883d3d3a3a0dcf5e59cdd5_1440w.Pk0Ya0.jpg 1.5x, https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-b26b65c7c3883d3d3a3a0dcf5e59cdd5_1440w.Pk0Ya0.jpg 2x"
        data-sizes="auto"
        alt="https://cdn.jsdelivr.net/gh/JoshuaChou2018/oss@main/uPic/v2-b26b65c7c3883d3d3a3a0dcf5e59cdd5_1440w.Pk0Ya0.jpg"
        title="img" /></p>
<p>选择网络上的分区，输入账号密码连接即可。</p>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2022-01-29</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"><span>
                            <a class="link-to-markdown" href="/%E6%90%AD%E5%BB%BAtimemachine-%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%BD%AC%E8%BD%BD/index.md" target="_blank">Read Markdown</a>
                        </span></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on Twitter" data-sharer="twitter" data-url="https://www.joshuachou.ink/%E6%90%AD%E5%BB%BAtimemachine-%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%BD%AC%E8%BD%BD/" data-title="搭建Time Machine 服务器 （转载）" data-hashtags="system,linux"><i class="fab fa-twitter fa-fw"></i></a><a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="https://www.joshuachou.ink/%E6%90%AD%E5%BB%BAtimemachine-%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%BD%AC%E8%BD%BD/" data-hashtag="system"><i class="fab fa-facebook-square fa-fw"></i></a><a href="javascript:void(0);" title="Share on Linkedin" data-sharer="linkedin" data-url="https://www.joshuachou.ink/%E6%90%AD%E5%BB%BAtimemachine-%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%BD%AC%E8%BD%BD/"><i class="fab fa-linkedin fa-fw"></i></a><a href="javascript:void(0);" title="Share on WhatsApp" data-sharer="whatsapp" data-url="https://www.joshuachou.ink/%E6%90%AD%E5%BB%BAtimemachine-%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%BD%AC%E8%BD%BD/" data-title="搭建Time Machine 服务器 （转载）" data-web><i class="fab fa-whatsapp fa-fw"></i></a><a href="javascript:void(0);" title="Share on Hacker News" data-sharer="hackernews" data-url="https://www.joshuachou.ink/%E6%90%AD%E5%BB%BAtimemachine-%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%BD%AC%E8%BD%BD/" data-title="搭建Time Machine 服务器 （转载）"><i class="fab fa-hacker-news fa-fw"></i></a><a href="javascript:void(0);" title="Share on Line" data-sharer="line" data-url="https://www.joshuachou.ink/%E6%90%AD%E5%BB%BAtimemachine-%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%BD%AC%E8%BD%BD/" data-title="搭建Time Machine 服务器 （转载）"><i data-svg-src="https://cdn.jsdelivr.net/npm/simple-icons@2.14.0/icons/line.svg"></i></a><a href="javascript:void(0);" title="Share on 微博" data-sharer="weibo" data-url="https://www.joshuachou.ink/%E6%90%AD%E5%BB%BAtimemachine-%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%BD%AC%E8%BD%BD/" data-title="搭建Time Machine 服务器 （转载）" data-ralateuid="6285763593"><i class="fab fa-weibo fa-fw"></i></a><a href="javascript:void(0);" title="Share on Evernote" data-sharer="evernote" data-url="https://www.joshuachou.ink/%E6%90%AD%E5%BB%BAtimemachine-%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%BD%AC%E8%BD%BD/" data-title="搭建Time Machine 服务器 （转载）"><i class="fab fa-evernote fa-fw"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw"></i>&nbsp;<a href="/tags/system/">system</a>,&nbsp;<a href="/tags/linux/">linux</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/lc10.regular_expression_matching/" class="prev" rel="prev" title="lc10. Regular Expression Matching"><i class="fas fa-angle-left fa-fw"></i>lc10. Regular Expression Matching</a>
            <a href="/lc938.range_sum_of_bst/" class="next" rel="next" title="lc938. Range Sum of BST">lc938. Range Sum of BST<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
<div id="comments"><div id="utterances"></div><noscript>
                Please enable JavaScript to view the comments powered by <a href="https://utteranc.es/">Utterances</a>.
            </noscript></div></article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2020 - 2022</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="/" target="_blank">Juexiao Zhou</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery.js@1.2.0/dist/css/lightgallery.min.css"><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/smooth-scroll@16.1.3/dist/smooth-scroll.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/autocomplete.js@0.37.1/dist/autocomplete.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lunr@2.3.8/lunr.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.2.2/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/twemoji@13.0.0/dist/twemoji.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lightgallery.js@1.2.0/dist/js/lightgallery.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lg-thumbnail.js@1.2.0/dist/lg-thumbnail.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lg-zoom.js@1.2.0/dist/lg-zoom.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/sharer.js@0.4.0/sharer.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":10},"comment":{"utterances":{"darkTheme":"github-dark","issueTerm":"url","label":"","lightTheme":"github-light","repo":"JoshuaChou2018/me"}},"lightGallery":{"actualSize":false,"exThumbImage":"data-thumbnail","hideBarsDelay":2000,"selector":".lightgallery","speed":400,"thumbContHeight":80,"thumbWidth":80,"thumbnail":true},"search":{"highlightTag":"em","lunrIndexURL":"/index.json","maxResultLength":30,"noResultsFound":"No results found","snippetLength":30,"type":"lunr"},"twemoji":true};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
